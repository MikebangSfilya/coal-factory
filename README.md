# Coal Factory

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ Go, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —Ä–∞–±–æ—Ç—É —Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å—é, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏ –∏ REST API —á–µ—Ä–µ–∑ –∏–≥—Ä–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É.

–ò–≥—Ä–æ–≤–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –≥–æ—Ä–Ω–æ-—Ä—É–¥–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –≤ –Ω–µ–∫–æ–π –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Å –ø–æ—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∑–∫–∏–º —É—Ä–æ–≤–Ω–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è, –≤–µ—Å—å —É–≥–æ–ª—å –¥–æ —Å–∏—Ö –ø–æ—Ä –¥–æ–±—ã–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é, –∞ –∑–∞—Ä–ø–ª–∞—Ç–∞ —Ä–∞–±–æ—á–∏–º –≤—ã–¥–∞–µ—Ç—Å—è –∏—Ö –∂–µ –¥–æ–±—ã—Ç–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç—å—é. 

## –¶–µ–ª—å –∏–≥—Ä—ã

–í–∞—à–∞ —Ü–µ–ª—å –∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–ª—É—á—à–∏—Ç—å —É—Å–ª–æ–≤–∏—è —Ç—Ä—É–¥–∞ –±–µ–¥–Ω—ã—Ö —à–∞—Ö—Ç—ë—Ä–æ–≤, –∫—É–ø–∏–≤ 3 –≤–∏–¥–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è: 
- –ö–∏—Ä–∫–∏, –≤–µ–¥—å –∏—Ö –∑–∞–±—ã–ª –≤—ã–¥–∞—Ç—å –ø—Ä–æ—Ä–∞–±. –¶–µ–Ω–∞ 3_000 —É–≥–ª—è
- –í–µ–Ω—Ç–∏–ª—è—Ü–∏—é, –∏–Ω–∞—á–µ –≤—Å–µ—Ö –≤–∞—à–∏—Ö –±—Ä–∞–≤—ã—Ö —Ä–∞–±–æ—Ç—è–≥ –Ω–∞—Å—Ç–∏–≥–Ω–µ—Ç –ø–Ω–µ–≤–º–æ–∫–æ–Ω–∏–æ–∑. –¶–µ–Ω–∞ 15_000 —É–≥–ª—è
- –í–∞–≥–æ–Ω–µ—Ç–∫–∏, —á—Ç–æ–±—ã —à–∞—Ö—Ç–µ—Ä—ã –Ω–µ –Ω–æ—Å–∏–ª–∏ —Ç–æ–Ω–Ω—ã —É–≥–ª—è –≤ —Å–≤–æ–∏—Ö —Ä—É–∫–∞—Ö. –¶–µ–Ω–∞ 50_000

*–° –º–æ—Ä–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è -- –≤—Å–µ —Ä–∞–±–æ—á–∏–µ –ª–∏—à—å –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –∏ –¥–∞–∂–µ –µ—Å–ª–∏ –≤–∞–º –∑–∞—Ö–æ—á–µ—Ç—Å—è –≤–µ—á–Ω–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—á–∏—Ö –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, –≤—ã –ª–∏—à—å –±—É–¥–µ—Ç–µ –∂–∏—Ç—å –≤ –ø—Ä–æ–∫–ª—è—Ç–æ–º –º–∏—Ä–µ –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º–∏ –∏ —Å–æ–∑–¥–∞–ª–∏*

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/MikebangSfilya/coal-factory
cd coal-factory

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
go run ./main.go

# –°–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç –Ω–∞ :9091
curl http://localhost:9091/miners
```
## –ö–∞–∫ –∏–≥—Ä–∞—Ç—å 

### –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ 

–° —Å–∞–º–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –Ω–∞—à–µ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, –≤–æ–ª—à–µ–±–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –º—ã –ø–æ–ª—É—á–∞–µ–º —Ä–æ–≤–Ω–æ –æ–¥–Ω—É –µ–¥–∏–Ω–∏—Ü—É —É–≥–ª—è –≤ –æ–¥–Ω—É —Å–µ–∫—É–Ω–¥—É, –Ω–∏–∫—Ç–æ –Ω–µ –∑–Ω–∞–µ—Ç –∫—Ç–æ –µ–µ –¥–æ–±—ã–≤–∞–µ—Ç –∏ –∫—Ç–æ –µ–µ –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç, –≤–∞–º –Ω—É–∂–Ω–æ –ª–∏—à—å –∑–Ω–∞—Ç—å, —á—Ç–æ –≤—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Å—Ç–∞–Ω–µ—Ç–µ—Å—å –±–µ–∑ —É–≥–ª—è. 

### –†–∞–±–æ—á–∏–µ 

–ö –Ω–∞–π–º—É –¥–æ—Å—Ç—É–ø–Ω—ã 3 –≤–∏–¥–∞ —à–∞—Ö—Ç–µ—Ä–æ–≤, –æ—Å–Ω–æ–≤–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è –≤ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç—Ä—É–¥–∞, –∏—Ö –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–æ–±—ã—Ç–æ–≥–æ –∏–º–∏ —É–≥–ª—è

| –¢–∏–ø          | –°—Ç–æ–∏–º–æ—Å—Ç—å | –î–æ—Ö–æ–¥    | –≠–Ω–µ—Ä–≥–∏—è | –°–∫–æ—Ä–æ—Å—Ç—å |
| ------------ | --------- | -------- | ------- | -------- |
| **Little**   | 5 —É–≥–ª—è    | 1 —É–≥–ª—è   | 30      | 3 —Å–µ–∫    |
| **Normal**   | 50 —É–≥–ª—è   | 3 —É–≥–ª—è   | 45      | 2 —Å–µ–∫    |
| **Powerful** | 450 —É–≥–ª—è  | 10+ —É–≥–ª—è | 60      | 1 —Å–µ–∫    |

**Powerful** —Ä–∞–±–æ—á–∏–π —Å –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π –¥–æ–±—ã—á–µ–π —É–≥–ª—è —É–ª—É—á—à–∞–µ—Ç—Å—è –∏ –¥–æ–±—ã–≤–∞–µ—Ç –±–æ–ª—å—à–µ —É–≥–ª—è. –¢—Ä–∏ –µ–¥–∏–Ω–∏—Ü—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ–±—ã—á–∏ –∑–∞ —Ü–∏–∫–ª –¥–æ –∫–æ–Ω—Ü–∞ —Å–≤–æ–µ–π —Ä–∞–±–æ—á–µ–π —Å–º–µ–Ω—ã.

#### –ù–∞–µ–º —Ä–∞–±–æ—á–∏—Ö 

``` bash
# –ù–∞–Ω—è—Ç—å –º–∞–π–Ω–µ—Ä–∞
POST /miners
{"miner_type": "little"}  # little, normal, powerful
```

### –ü–æ–∫—É–ø–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è 
``` bash
# –ö—É–ø–∏—Ç—å –∫–∏—Ä–∫—É
POST /equipment/pick

# –ö—É–ø–∏—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ü–∏—é  
POST /equipment/vent

# –ö—É–ø–∏—Ç—å –≤–∞–≥–æ–Ω–µ—Ç–∫—É
POST /equipment/trolley
```

### –ü–æ–±–µ–¥–∞ 

–ò–≥—Ä–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—ã–∏–≥—Ä–∞–Ω–Ω–æ–π, –∫–æ–≥–¥–∞ –≤—ã –ø—Ä–∏–æ–±—Ä–µ–ª–∏ –≤—Å–µ 3 –≤–∏–¥–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è:
-  –ö–∏—Ä–∫–∞ (3,000 —É–≥–ª—è)
-  –í–µ–Ω—Ç–∏–ª—è—Ü–∏—è (15,000 —É–≥–ª—è)  
-  –í–∞–≥–æ–Ω–µ—Ç–∫–∞ (50,000 —É–≥–ª—è)

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã —Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å –æ–±—Ä–∞–∑—Ü–æ–≤—ã–º —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–µ–º –≤ —ç—Ç–æ–π —Å—É—Ä–æ–≤–æ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏!

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–±–µ–¥—ã:

`GET /win`

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥  | –≠–Ω–¥–ø–æ–∏–Ω—Ç        | –û–ø–∏—Å–∞–Ω–∏–µ               | –û—Ç–≤–µ—Ç                         |
| ------ | --------------- | ---------------------- | ----------------------------- |
| `POST` | `/miners`       | –ù–∞–Ω—è—Ç—å —Ä–∞–±–æ—á–µ–≥–æ        | JSON c `MinerInfo`            |
| `GET`  | `/miners/{id}`  | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —à–∞—Ö—Ç—ë—Ä–µ   | JSON c `MinerInfo`            |
| `GET`  | `/miners`       | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–∞–±–æ—á–∏—Ö    | JSON —Å–æ —Å–ø–∏—Å–∫–æ–º –≤—Å–µ—Ö —à–∞—Ö—Ç—ë—Ä–æ–≤ |
| `GET`  | `/balance`      | –ë–∞–ª–∞–Ω—Å —É–≥–ª—è            | `{ "balance": 123 }`          |
| `GET`  | `/items`        | –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è | —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤              |
| `POST` | `/items/{type}` | –ö—É–ø–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç         | –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏         |
| `GET`  | `/win`          | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã        | JSON —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π            |

**MinerInfo**:

```go
type MinerInfo struct {
¬† ¬† ID ¬† ¬† ¬† ¬†uuid.UUID
¬† ¬† MinerType MinerType
¬† ¬† CoalPower Coal
¬† ¬† Energy ¬† ¬†int64
¬† ¬† Cost ¬† ¬† ¬†int64

}
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- Go 1.24
- chi router
- goroutines, channels
- thread-safe –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- structured logging (`slog`)


